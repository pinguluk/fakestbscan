<html>

<head>
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, height=device-height, minimum-scale=1.0, user-scalable=0">
    <link href="https://cdn.jsdelivr.net/npm/reset-css@5.0.2/reset.min.css" rel="stylesheet">
    <style>
        /* html,
        body {
            width: 100%;
            height: 100%;
        } */

        @font-face {
            font-family: 'AscenderSansW01';
            src: url('AscenderSansW01-Bold.woff2') format('woff2'),
                url('AscenderSansW01-Bold.woff') format('woff');
            font-weight: bold;
            font-style: normal;
            font-display: swap;
        }

        body {
            background: black;
            padding: 10%;
            font-family: 'Courier New', Courier, monospace;
        }

        #text-container {
            display: flex;
            flex-wrap: wrap;
            min-height: 20%;
            align-items: center;
            justify-content: center;
            padding: 25px 0;
        }

        #text-container h1 {
            color: white;
            font-size: 3rem;
            text-align: center;
            font-weight: bold;
            min-height: 200px;
            display: flex;
            align-items: center;
        }

        .blue-background {
            background: #0660fc;
        }

        .red-background {
            background: red;
        }

        .green-background {
            background: green;
        }

        #nfc {
            height: 55%;
            display: flex;
            justify-content: center;
            align-items: flex-end;
        }

        #nfc #nfc-image {
            margin-bottom: 25%;
            filter: brightness(100);
            width: 100%;
            max-width: 800px;
            pointer-events: none;
            fill: white;
        }

        .overlay {
            position: absolute;
            left: 0;
            bottom: 0;
            height: 50%;
            width: 100%;
        }

        #overlay-success {
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 50%;
            /* background: green; */
        }

        #overlay-error {
            position: absolute;
            right: 0;
            top: 0;
            height: 100%;
            width: 50%;
            /* background: red;; */
        }

        #subtext {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            width: 100%;
            color: white;
            margin: 0 15px;
        }
    </style>
</head>

<body>
    <section id="text-container" class="blue-background">
        <h1>Validare<br> card</h1>
        <div id="subtext">
            <div>Linia:666</div>
            <div id="dateTimeDisplay"></div>
        </div>
    </section>
    <section id="nfc">
        <div class="overlay">
            <div class="overlay-element" id="overlay-success" data-scan-result="success"></div>
            <div class="overlay-element" id="overlay-error" data-scan-result="error"></div>
        </div>
        <div id="nfc-container">
            <img id="nfc-image" src="nfc.svg">
        </div>
    </section>

    <script>
        const soundEffects = {
            scan: new Audio('sounds/scan-1.mp3'),
            success: new Audio('sounds/success-1.mp3'),
            error: new Audio('sounds/error-1.mp3'),
        }

        // let currentFakeScanResult = "error";

        // Set the hold duration in milliseconds (e.g., 3000 ms = 3 seconds)
        const holdDuration = 500;
        let holdTimeout;

        const textContainer = document.getElementById("text-container");
        const text = document.querySelector("h1");
        const overlayElements = document.querySelectorAll(".overlay-element");

        // Function to handle hold detection
        function startHoldDetection(element) {
            holdTimeout = setTimeout(() => {
                displayScanningResult();
                setTimeout(() => {
                    displayScanResult(element);
                }, 1000);
                // Add any action here when hold duration is met
            }, holdDuration);
        }

        // Clear timeout when hold is released
        function clearHoldDetection() {
            clearTimeout(holdTimeout);
        }

        function displayScanResult(element) {
            const scanResult = element.dataset.scanResult;
            if (scanResult === "success") {
                displaySuccessResult();
            }
            else if (scanResult === "error") {
                displayErrorResult();
            }
        }

        function displayDefaultText() {
            text.innerHTML = `Validare card`;
            textContainer.className = "blue-background";
        }

        function displayScanningResult() {
            soundEffects.scan.play();
            text.innerHTML = `Se valideazÄƒ cardul...`;
            textContainer.className = "blue-background";
            setTimeout(() => {
                displayDefaultText();
            }, 3000);
        }

        function displaySuccessResult() {
            soundEffects.success.play();
            text.innerHTML = `VALIDAT`;
            textContainer.className = "green-background";
            setTimeout(() => {
                displayDefaultText();
            }, 3000);
        }

        function displayErrorResult() {
            soundEffects.error.play();
            text.innerHTML = `NEVALIDAT`;
            textContainer.className = "red-background";
        }

        // Attach event listeners
        overlayElements.forEach(function (element) {
            element.addEventListener("mousedown", (e) => startHoldDetection(element));
            element.addEventListener("mouseup", clearHoldDetection);
            element.addEventListener("mouseleave", clearHoldDetection); // Clear if the mouse leaves the element

            element.addEventListener("touchstart", (e) => startHoldDetection(element));
            element.addEventListener("touchend", clearHoldDetection);
            element.addEventListener("touchcancel", clearHoldDetection); // Clear if the touch is canceled
        });

        // Function to format and display the date and time
        function updateDateTime() {
            const now = new Date();
            const day = String(now.getDate()).padStart(2, '0');
            const month = String(now.getMonth() + 1).padStart(2, '0'); // Months are zero-based
            const year = String(now.getFullYear()).slice(-2); // Get last two digits of the year
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const seconds = String(now.getSeconds()).padStart(2, '0');

            // Format as dd.mm.yy/hh:mm:ss
            const formattedDateTime = `${day}.${month}.${year}/${hours}:${minutes}:${seconds}`;

            // Set the formatted date and time to the div
            document.getElementById("dateTimeDisplay").textContent = formattedDateTime;
        }

        // Update the date and time immediately and then every second
        updateDateTime();
        setInterval(updateDateTime, 1000);

    </script>

</body>

</html>